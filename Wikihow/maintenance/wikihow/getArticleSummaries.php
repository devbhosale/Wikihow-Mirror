<?php
//
// One time script to get a csv of article summaries from a list of article ids
//

require_once __DIR__ . '/../../Maintenance.php';

class GetArticleSummaries extends Maintenance {
    public function __construct() {
        parent::__construct();
        $this->mDescription = 'One time script to get a csv of article summaries from a list of article ids';
    }

    public function execute() {
		$aids = [
			245296,
			74335,
			129067,
			138826,
			5501,
			20988,
			302178,
			1563065,
			3811,
			1384501,
			23135,
			1231311,
			1877831,
			333425,
			6866,
			27354,
			8460,
			120138,
			6334,
			347457,
			181088,
			10053,
			29851,
			85793,
			1390477,
			223397,
			99491,
			1107820,
			6259,
			39808,
			239181,
			1132955,
			159274,
			171769,
			31325,
			6253,
			7495,
			101365,
			514039,
			664019,
			1158109,
			1336085,
			308248,
			2693335,
			1222091,
			3399,
			53885,
			18867,
			26327,
			2330,
			1854236,
			10605,
			4932,
			254308,
			1183052,
			12058,
			1622135,
			1366814,
			18749,
			235528,
			3646378,
			1977694,
			3518097,
			22075,
			282854,
			281633,
			1297214,
			2440219,
			66903,
			728025,
			2889360,
			11717,
			1406062,
			559549,
			1024762,
			287541,
			44772,
			89898,
			332694,
			596891,
			1046194,
			14148,
			26355,
			1836235,
			747378,
			996403,
			854754,
			285360,
			1445967,
			20242,
			688393,
			1179404,
			5252236,
			114433,
			253947,
			841973,
			2856,
			339561,
			2160213,
			494477,
			13268,
			18201,
			6174281,
			448005,
			926378,
			8663332,
			45921,
			213692,
			23944,
			527030,
			6761844,
			3093292,
			1593,
			617974,
			2446955,
			508383,
			38925,
			58161,
			46021,
			289422,
			130659,
			401260,
			156554,
			789233,
			1376320,
			315032,
			1967815,
			2910197,
			1369707,
			103421,
			787292,
			19929,
			723047,
			1997101,
			2033272,
			686023,
			3726,
			128647,
			66809,
			40273,
			39370,
			42886,
			1090550,
			323929,
			121049,
			1257275,
			2947423,
			1422134,
			95903,
			5144,
			15456,
			3494648,
			1008097,
			122895,
			144746,
			143190,
			1017643,
			1312335,
			370177,
			1947695,
			1843,
			126091,
			241783,
			35104,
			10011,
			1059391,
			1354478,
			1700101,
			696532,
			3746462,
			1703790,
			6775,
			275127,
			2339649,
			1098885,
			15942,
			382569,
			8586848,
			1373843,
			6599,
			1609182,
			2158314,
			2516468,
			1623698,
			310784,
			8015105,
			88305,
			1836145,
			1297203,
			1349300,
			1361618,
			2259893,
			147339,
			9673,
			5318180,
			3676899,
			150727,
			190097,
			2200384,
			1382488,
			3760241,
			1967792,
			218571,
			44631,
			1110104,
			1446499,
			1577096,
			3684666,
			265096,
			1338936,
			1090555,
			48695,
			54812,
			3823,
			2695791,
			1373679,
			1695939,
			15216,
			1427503,
			55442,
			1515668,
			780484,
			17015,
			2808632,
			1623497,
			3230446,
			9571852,
			109362,
			11858,
			36891,
			660329,
			385796,
			45038,
			4943,
			4297,
			149992,
			75152,
			19207,
			89756,
			103833,
			16246,
			65133,
			24786,
			1710458,
			658582,
			595826,
			307128,
			115112,
			176302,
			3741870,
			561616,
			468831,
			707057,
			150234,
			264772,
			978810,
			47908,
			9153,
			136497,
			22372,
			23171,
			17589,
			34117,
			12801,
			3630499,
			2229738,
			1656863,
			193859,
			21502,
			180708,
			1191089,
			33391,
			213506,
			30513,
			11008,
			391424,
			562522,
			2574069,
			24337,
			2702786,
			6923,
			142220,
			30137,
			267111,
			2400935,
			14285,
			2436546,
			490921,
			1433885,
			302127,
			1422628,
			149535,
			171250,
			804559,
			222112,
			120920,
			689942,
			247680,
			697620,
			14052,
			245421,
			44944,
			1441490,
			174402,
			38365,
			2544050,
			156084,
			1441507,
			316138,
			137522,
			176589,
			152879,
			826404,
			83061,
			204796,
			413575,
			193815,
			1392798,
			1388193,
			2487737,
			67873,
			19993,
			110310,
			647971,
			9722,
			1091856,
			2862681,
			1389047,
			1278916,
			63782,
			3603,
			397434,
			399412,
			1023181,
			202794,
			191055,
			530386,
			666353,
			3057627,
			2552545,
			433909,
			3094248,
			9712,
			310819,
			10794,
			656417,
			3077659,
			157236,
			189737,
			26528,
			56474,
			372903,
			581606,
			729397,
			640838,
			568140,
			132025,
			381509,
			188252,
			221998,
			45015,
			178039,
			33915,
			140371,
			2021765,
			2913094,
			130528,
			281506,
			313918,
			1964913,
			503372,
			1611059,
			929013,
			652750,
			1698440,
			431554,
			2483250,
			903838,
			1798549,
			1578850,
			130981,
			2952492,
			2157327,
			795717,
			390889,
			1388493,
			662910,
			306693,
			307133,
			779738,
			2043686,
			658263,
			397309,
			1323263,
			1402248,
			8838955,
			4467,
			3728300,
			995738,
			6399,
			2876228,
			505107,
			37390,
			7085,
			5868,
			1380350,
			2153119,
			2519014,
			422323,
			8613,
			685626,
			1368161,
			1003478,
			27948,
			555176,
			174761,
			1020322,
			45648,
			2426481,
			3949195,
			642105,
			85338,
			3748335,
			2549421,
			3743791,
			3744313,
			1376652,
			190600,
			685777,
			3743929,
			667976,
			4587501,
			858821,
			926955,
			177944,
			1057716,
			2551730,
			4635099,
			3903702,
			244684,
			1997272,
			1556459,
			890272,
			149404,
			38755,
			328955,
			878263,
			4529242,
			26925,
			1562354,
			50925,
			2246183,
			8149176,
			32256,
			2169132,
			1267846,
			415522,
			87324,
			781889,
			115297,
			2851963,
			4130547,
			46614,
			13828,
			1356892,
			16184,
			4403346,
			1722484,
			2854494,
			85539,
			398910,
			876210,
			34691,
			3114660,
			152138,
			180608,
			27598,
			157844,
			1561101,
			1938215,
			765564,
			690585,
			427684,
			65349,
			65596,
			593042,
			401156,
			5647,
			1094244,
			114103,
			1695771,
			1225693,
			19958,
			70070,
			1712019,
			686076,
			872566,
			424631,
			1169303,
			52514,
			793322,
			36682,
			2657940,
			3311347,
			80700,
			658176,
			6466822,
			187600,
			111789,
			1972,
			1108878,
			42558,
			677908,
			2568318,
			206036,
			2850584,
			1581205,
			24621,
			3108900,
			842206,
			2597815,
			3445600,
			3169671,
			62995,
			1199891,
			2762753,
			3353857,
			454000,
			1329353,
			19692,
			2074,
			10217,
			2566074,
			1336543,
			722746,
			103761,
			895449,
			2571103,
			1167115,
			2780847,
			3093512,
			6703,
			2768446,
			3227213,
			1273953,
			46692,
			324586,
			26241,
			2591497,
			2449,
			1253043,
			2931157,
			2587011,
			3142273,
			61892,
			3311355,
			516413,
			24190,
			1351224,
			1638198,
			6498,
			151157,
			177842,
			9430094,
			26601,
			491886,
			235416,
			42132,
			278836,
			2244897,
			9020045,
			1385166,
			480256,
			4877913,
			399652,
			860690,
			26048,
			408180,
			15181,
			290095,
			1332752,
			1603979,
			225265,
			1408906,
			25072,
			1221975,
			229281,
			2455263,
			41504,
			132701,
			573870,
			171556,
			19396,
			268766,
			24181,
			795714,
			797268,
			286729,
			1533955,
			1054667,
			9845,
			42363,
			905703,
			685473,
			9889,
			176723,
			1391114,
			1035745,
			6522,
			26479,
			39175,
			181759,
			3311811,
			3247220,
			1127187,
			1109881,
			1399863,
			697961,
			592130,
			1111104,
			1384998,
			3593205,
			1060822,
			1065477,
			1350001,
			1108890,
			82841,
			663360,
			58255,
			498366,
			1986250,
			2163297,
			323992,
			1300989,
			3248471,
			42911,
			1151588,
			301100,
			1060823,
			26522,
			170420,
			1224781,
			185084,
			1220019,
			3923962,
			134528,
			128123,
			297740,
			837621,
			848514,
			800859,
			235206,
			443561,
			1352421,
			2729084,
			28754,
			144810,
			915407,
			19742,
			59270,
			7432,
			20969,
			1220738,
			4024458,
			78093,
			462910,
			4114680,
			178833,
			44975,
			1345859,
			3115,
			539062,
			78583,
			14904,
			3925223,
			1334112,
			1452078,
			110365,
			1331466,
			3454985,
			137821,
			40135,
			2570999,
			1354602,
			306716,
			49633,
			1375490,
			2793487,
			1564706,
			1098889,
			47145,
			1019642,
			56036,
			807854,
			513364,
			218418,
			161148,
			27629,
			2318856,
			47930,
			580826,
			9232113,
			2449277,
			1228359,
			1115159,
			2457267,
			45087,
			1860601,
			2934675,
			254068,
			1299686,
			3260642,
			135618,
			3191576,
			9439516,
			9418406,
			22309,
			39777,
			2679571,
			2491960,
			96262,
			149293,
			57537,
			31060,
			1356918,
			84781,
			41150,
			70137,
			83897,
			4308,
			63012,
			23676,
			704534,
			2286665,
			1307729,
			22911,
			2605663,
			149499,
			2646629,
			384942,
			268997,
			899648,
			14445,
			102262,
			1395070,
			1398331,
			160701,
			319084,
			461929,
			8945,
			179983,
			284712,
			10414,
			159969,
			661783,
			19222,
			1355310,
			45868,
			680992,
			213926,
			78133,
			387178,
			81099,
			33231,
			59701,
			25685,
			293267,
			1179307,
			167443,
			1978072,
			98087,
			100021,
			1605996,
			3204519,
			117777,
			171439,
			322794,
			1800408,
			8041,
			2809967,
			2926956,
			1128266,
			5425,
			503043,
			306789,
			244243,
			1079966,
			975669,
			1441468,
			1187429,
			16186,
			1037603,
			1400419,
			3571424,
			32591,
			41306,
			205537,
			865555,
			2909853,
			398030,
			1066799,
			23126,
			21901,
			9853,
			4277962,
			2707302,
			1059779,
			887950,
			1622,
			1782,
			3698458,
			14013,
			1194030,
			17755,
			28104,
			1257063,
			3346252,
			84253,
			4023909,
			6868,
			657589,
			93902,
			3141,
			90767,
			479017,
			15956,
			415828,
			2816442,
			279762,
			240528,
			207083,
			3854,
			1563396,
			389578,
			1342122,
			1914350,
			2641303,
			103670,
			1334672,
			248920,
			651251,
			216205,
			1330600,
			1374508,
			20974,
			247586,
			77985,
			1513345,
			779814,
			1174432,
			388855,
			2723493,
			950002,
			9164154,
			2344358,
			1231964,
			643490,
			275827,
			26377,
			2855828,
			118372,
			305858,
			132726,
			1400198,
			26702,
			644383,
			5775245,
			1360388,
			315780,
			6774,
			2636057,
			362959,
			5475406,
			290160,
			191901,
			1341769,
			1028413,
			6768,
			121087,
			204610,
			861025,
			693342,
			3435008,
			393361,
			8791805,
			949999,
			61398,
			1330480,
			54243,
			443139,
			931728,
			314762,
			1903,
			44302,
			2145389,
			3516,
			400896,
			620514,
			59634,
			357847,
			34356,
			41421,
			28927,
			647173,
			18187,
			1218467,
			27807,
			705984,
			812575,
			151550,
			7357,
			815399,
			58095,
			710870,
			311062,
			2762886,
			8570867,
			34326,
			399924,
			33060,
			7018,
			135695,
			37898,
			1409045,
			756547,
			1278925,
			730375,
			2986663,
			83312,
			258833,
			23722,
			1161559,
			2227049,
			49347,
			9592653,
			8940658,
			8570859,
			8326974,
			7697836,
			3044449,
			1151582,
			9024587,
			1084835,
			767324,
			2205089,
			73875,
			6455354,
			6463711,
			9074030,
			6799843,
			87888,
			206920,
			18474,
			458971,
			64859,
			346468,
			2646569,
			10307,
			1367588,
			696130,
			4655999,
			1554129,
			215483,
			1538469,
			3346314,
			1249958,
			1474990,
			12367,
			71901,
			1432538,
			381649,
			1375483,
			1787465,
			2771347,
			45475,
			15072,
			1503295,
			23823,
			70525,
			2850587,
			186922,
			183703,
			69928,
			5024,
			115174,
			36431,
			594153,
			2959784,
			696090,
			31638,
			375884,
			24645,
			2991742,
			1233426,
			206341,
			1169298,
			571309,
			22837,
			83171,
			872534,
			4420660,
			1578350,
			1205130,
			4165024,
			34204,
			3170814,
			491484,
			1802252,
			114979,
			923587,
			17710,
			193141,
			2654541,
			1375099,
			312809,
			3002587,
			691395,
			26833,
			1363010,
			822205,
			1330048,
			76166,
			33866,
			10020,
			21983,
			475823,
			2606212,
			7800,
			4150,
			27464,
			42937,
			94253,
			45190,
			2119100,
			413339,
			88034,
			653199,
			260214,
			357113,
			222267,
			1090556,
			132500,
			178713,
			54279,
			474728,
			242400,
			147205,
			164839,
			53972,
			132808,
			129431,
			29731,
			153296,
			71998,
			227616,
			760404,
			19211,
			711701,
			2428072,
			2600157,
			37277,
			63333,
			1821946,
			1675593,
			278551,
			150748,
			962620,
			47711,
			25795,
			263796,
			13053,
			30293,
			25394,
			155200,
			546159,
			518011,
			38528,
			464870,
			127469,
			42249,
			1827376,
			11526,
			176944,
			288871,
			1616805,
			915362,
			935831,
			721035,
			177021,
			157126,
			57907,
			2992512,
			182663,
			437551,
			188753,
			41603,
			179751,
			2599685,
			201974,
			695049,
			830109,
			4126,
			488695,
			675276,
			717709,
			1021142,
			619197,
			92360,
			3468848,
			981284,
			1085482,
			71570,
			768627,
			515916,
			409101,
			2536,
			132258,
			24391,
			3606,
			456442,
			178377,
			6904660,
			268951,
			978386,
			166709,
			327385,
			22286,
			201691,
			22097,
			40500,
			19242,
			1192443,
			22782,
			2975157,
			1276427,
			799612,
			8668890,
			1370844,
			3349720,
			2816234,
			4646,
			699931,
			4477904,
			4573737,
			14093,
			25067,
			2805092,
			97949,
			13169,
			4962,
			204456,
			4400133,
			1422873,
			1125072,
			1276882,
			486522,
			1568759,
			2676346,
			79229,
			8003306,
			3264157,
			279546,
			511761,
			7747,
			466584,
			305173,
			2649671,
			55117,
			1201618,
			676266,
			1367731,
			165046,
			19916,
			736262,
			29146,
			1401842,
			351030,
			405458,
			2360,
			2905441,
			6548,
			6427,
			25266,
			24869,
			113347,
			17739,
			5951,
			78537,
			28721,
			91322,
			288995,
			5830,
			26446,
			1965563,
			22932,
			2794015,
			2657511,
			1472244,
			1211907,
			45723,
			25673,
			1375794,
			57203,
			413939,
			3476,
			1641711,
			10339,
			7111,
			45423,
			2905560,
			2202673,
			19455,
			41965,
			375502,
			1483458,
			4835682,
			18166,
			98037,
			177595,
			170008,
			1555,
			47222,
			400630,
			26914,
			565606,
			291036,
			112541,
			722793,
			115249,
			1452809,
			103586,
			586759,
			10860,
			114064,
			17636,
			839305,
			234965,
			1371612,
			3182338,
			2448869,
			911636,
			2855957,
			642092,
			231977,
			1227344,
			1694952,
			312975,
			3181570,
			1083621,
			360635,
			8562491,
			1412189,
			3949632,
			1410640,
			757889,
			3732035,
			4099876,
			1207952,
			1201619,
			642424,
			1361806,
			22939,
			2929956,
			1445640,
			1390946,
			8503,
			42438,
			78444,
			6257,
			614130,
			272658,
			210218,
			17792,
			2246,
			1892052,
			688406,
			148675,
			320614,
			1491781,
			648080,
			88187,
			354573,
			100648,
			35430,
			31630,
			20329,
			1350525,
			3557766,
			165555,
			111044,
			736670,
			1450988,
			1139527,
			1101379,
			652321,
			5800686,
			319398,
			703191,
			2723707,
			35882,
			1234274,
			508480,
			336195,
			3307579,
			46649,
			2227182,
			441687,
			843485,
			88662,
			9742,
			28056,
			388925,
			73782,
			1449222,
			282285,
			47414,
			47412,
			816432,
			1662572,
			21444,
			822571,
			2723286,
			1334375,
			15463,
			230610,
			4714435,
			1098888,
			191169,
			1384999,
			1393314,
			2663397,
			3191247,
			2765712,
			566932,
			42651,
			43983,
			2771,
			25723,
			42053,
			4831,
			204663,
			63329,
			335459,
			2930601,
			14216,
			1139048,
			1339302,
			1221221,
			1556237,
			28258,
			57956,
			146832,
			37235,
			1377544,
			1343493,
			54704,
			47464,
			2780554,
			105170,
			2809859,
			5207,
			1380727,
			1449185,
			404006,
			504338,
			34360,
			1721796,
			345757,
			472946,
			95385,
			1126246,
			189365,
			5022062,
			54683,
			13875,
			4380618,
			6747,
			43568,
			8092,
			1106964,
			1469603,
			25000,
			1370636,
			1118187,
			11422,
			1307851,
			3090,
			7233883,
			478475,
			100364,
			575408,
			2142210,
			8870933,
			20886,
			1339002,
			96734,
			621794,
			1616000,
			655699,
			320316,
			1363375,
			1300520,
			2275039,
			215972,
			11679,
			19239,
			5079,
			2375,
			3097,
			2658144,
			105513,
			1821704,
			127729,
			1429268,
			184515,
			2415,
			1339226,
			1107828,
		];
	    $fp = fopen('articleSummaries.csv', 'w');
	    fputcsv($fp, ['Article ID', 'Url', 'Summary', 'Error']);
		for ($i = 0; $i < sizeof($aids); $i++) {
			$aid = $aids[$i];
			$url = '';
			$summaryText = '';
			$errorText = '';
			$t = Title::newFromId($aid);

			if ($t && $t->exists()) {
				$url = 'https://www.wikihow.com/' . $t->getPartialUrl();
				$json = file_get_contents(
					"https://www.wikihow.com/api.php?action=articletext&aid=$aid&format=json");
				$obj = json_decode($json);
				//var_dump($obj);

				if (!$obj) {
					$errorText = 'No data returned from API call';
				} elseif ($obj->data->summaryText) {
					$summaryText = $obj->data->summaryText;
				} else {
					$errorText = 'Empty summary';
				}
			} else {
				$errorText = 'Title not found';
			}
			fputcsv($fp,
				[$aid, $url, $summaryText, $errorText]);
			echo "$aid\t$url\tError:$errorText\n";
		}
		fclose($fp);
    }
}

$maintClass = 'GetArticleSummaries';
require_once RUN_MAINTENANCE_IF_MAIN;
